{
    "collab_server" : "",
    "contents" : "#----------------------------------------------------\n# Looking at the db that Brenton Chookolingo\n# has created during his time at PFC\n# Also looking at the data Juha provided for his stand\n# reconstruction sites.\n#\n# This ultimate goal is to use both climate and \n# remotely sensing info to analyse the productivity\n# measurements and estimates on Juha's and Ted's plots\n# CBoisvenue\n# April 14, 2016\n#----------------------------------------------------\n\n\nlibrary(data.table)\n\nlist.files(\"C:/Celine/data/Juha/\")\n# [1] \"DataDocumentation.xlsx\"         \"MeasData.csv\"                  \n# [3] \"MODIS Climate Database v10.csv\" \"PlotData.csv\"                  \n# [5] \"StudyData.csv\"                  \"TreeData.csv\"  \n\n# database from Brenton  April 2016\n# climate info mostly\ndb1 <- fread(\"M:/Brenton/MODIS Climate Database v11.csv\")\n# Why are there a bunch of NAs?\ndim(db1)\n# [1] 236262     66\nwhich(is.na(db1$Year))[1:20]\n# [1] 142561 142562 142563 142564 142565 142566 142567 142568 142569 142570 142571 142572\n# [13] 142573 142574 142575 142576 142577 142578 142579 142580\ndb1[which(is.na(db1$Year))[1:20]]\n\n\n\n# Files from Juha April 2016\n# description of their content here \"DataDocumentation.xlsx\" \n# unique identifier is PLOTID\n# general info study sites/plots\nstudy <- fread(\"C:/Celine/data/Juha/StudyData.csv\")\n# measurement inof like number and date, has plot age\nmeas <- fread(\"C:/Celine/data/Juha/MeasData.csv\") # has age\n\nplot1 <- fread(\"C:/Celine/data/Juha/PlotData.csv\")\ntree <- fread(\"C:/Celine/data/Juha/TreeData.csv\") \n\n# Juha's already calculated fluxes -  only done for some sites\nddir <- \"C:/Celine/data/Juha/\"\n\n\n\n\n# These lines below are from my SK PSPs to calculate biomass per tree...\n### I HAVE NOT LOOKED AT THIS YET\n# Biomass calculations -------------------------------------------------------------------------\n# Calculate biomass for all trees in data frame-------------------------------------------------\n# calculate biomass for all trees with dbh by year\nparams1 <- read.table(\"C:/Celine/CelineSync/RES_Work/Work/JoanneWhite/SK_work/GrowthRaster/BiomassEstimation/SK_SPSBiomassParametersChecked.csv\",sep=\",\", header=TRUE)\nparams2 <- read.table(\"C:/Celine/CelineSync/RES_Work/Work/JoanneWhite/SK_work/GrowthRaster/BiomassEstimation/SK_SPSBiomassParametersCheckedDBH_only.csv\",sep=\",\", header=TRUE)\nparams2 <- params2[1:9,1:9]\n\n# biomass\nbiom.tree1 <- left_join(biom9,params2) \n\nbiom.dbh <- mutate(biom.tree1,wood.dbh=b1w*(DBH^b2w),bark.dbh =b1b*(DBH^b2b),\n                   branches.dbh = b1br*(DBH^b2br),foliage.dbh = b1f*(DBH^b2f),\n                   biom.dbh = wood.dbh+bark.dbh+foliage.dbh+branches.dbh) %>%\n  select(PLOT_ID,TREE_NO,YEAR,SPECIES,HEIGHT,age,DBH,wood.dbh,bark.dbh,branches.dbh,foliage.dbh,biom.dbh)\n\nbiom.tree2 <- left_join(biom9,params1) \n\nbiom.tree3 <- mutate(biom.tree2,wood=b1w*(DBH^b2w)*(HEIGHT^b3w),bark =b1b*(DBH^b2b)*(HEIGHT^b3b),\n                     branches = b1br*(DBH^b2br)*(HEIGHT^b3br),foliage = b1f*(DBH^b2f)*(HEIGHT^b3f),\n                     biomass = wood+bark+foliage+branches) %>%\n  select(PLOT_ID,TREE_NO,YEAR,SPECIES,dom, HEIGHT,age,DBH,wood,bark,branches,foliage,biomass)\n\nbiom.tree4 <- inner_join(biom.tree3,biom.dbh)\n\nwrite.table(biom.tree4,file=\"C:/Celine/CelineSync/RES_Work/Work/JoanneWhite/SK_work/data/CleanedUpForUsing/SK_2000TreeBiomass.csv\",sep=\",\",row.names = FALSE)\n\n# biomass from these equations are in kg\nggplot(data=biom.tree4) + geom_bar(aes(biomass, fill=SPECIES),colour=\"black\")\n# there might only be one tree over 1000\nbiomcheck1 <- filter(biom.tree4,biomass>=1000) \nggplot(data=biomcheck1) + geom_bar(aes(biomass, fill=SPECIES),colour=\"black\")\ndim(biomcheck1)#[1] 460  12\nbiomcheck2 <- filter(biom.tree4, biomass<1000)\nggplot(data=biomcheck2) + geom_bar(aes(biomass, fill=SPECIES),colour=\"black\")\n# distribution looks ok\n# Results ok\n# End of calculating biomass per tree--------------------------------------------------------------\n",
    "created" : 1481064214852.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1335484631",
    "id" : "B535C4F2",
    "lastKnownWriteTime" : 1467224925,
    "last_content_update" : 1467224925,
    "path" : "C:/Celine/GitHub/R_collaboration/ExploreBChookolingoDB.r",
    "project_path" : "ExploreBChookolingoDB.r",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}